{
  "input": {
    "message": "{\"@version\": \"1\", \"agent\": {\"agentid\": \"00000000-0000-0000-0000-000000000000\", \"distroid\": null, \"domainname\": \"domain123\", \"ostype\": \"windows\", \"hostname\": \"pc123\", \"osversion\": \"10.0.19041\", \"osproducttype\": \"Windows 10 Pro\", \"domain\": null, \"version\": \"2.12.6\"}, \"type\": \"rtlogs\", \"alert_subtype\": \"process\", \"log_type\": \"alert\", \"detection_origin\": \"agent\", \"tenant\": \"\", \"alert_time\": \"2022-03-15T07:26:01.276+00:00\", \"alert_type\": \"sigma\", \"status\": \"false_positive\", \"rule_id\": \"00000000-0000-0000-0000-000000000000\", \"@event_create_date\": \"2022-03-15T07:26:01.276Z\", \"alert_unique_id\": \"00000000-0000-0000-0000-000000000000\", \"level\": \"low\", \"aggregation_key\": \"123456\", \"@timestamp\": \"2022-03-15T07:26:01.311Z\", \"tags\": [\"attack.discovery\", \"attack.t1057\", \"attack.s0057\"], \"process\": {\"detection_timestamp\": \"2022/03/15 07:24:54.438105\", \"process_unique_id\": \"00000000-0000-0000-0000-000000000000\", \"parent_integrity_level\": \"Medium\", \"log_platform_flag\": 0, \"fake_parent_image\": null, \"pid\": 11320, \"image_name\": \"C:\\\\Windows\\\\SysWOW64\\\\tasklist.exe\", \"username\": \"XXX\\\\XXX\", \"logonid\": 151210562, \"signature_info\": {\"signed_authenticode\": false, \"signed_catalog\": true, \"root_info\": {\"thumbprint\": \"3b1efd3a66ea28b16697394703a72ca340a05bd5\", \"display_name\": \"Microsoft Root Certificate Authority 2010\", \"serial_number\": \"28cc3a25bfba44ac449a9b586b4339aa\", \"issuer_name\": \"Microsoft Root Certificate Authority 2010\"}, \"signer_info\": {\"thumbprint\": \"f7c2f2c96a328c13cda8cdb57b715bdea2cbd1d9\", \"display_name\": \"Microsoft Windows\", \"serial_number\": \"33000002ec6579ad1e670890130000000002ec\", \"issuer_name\": \"Microsoft Windows Production PCA 2011\"}}, \"current_directory\": \"C:\\\\Program Files (x86)\\\\EPOS\\\\EPOS Connect\", \"error_msg\": \"\", \"status_msg\": \"sigma match detected this process but not configured to block it\", \"ppid\": 17808, \"fake_parent_commandline\": null, \"commandline\": \"tasklist\", \"signed\": true, \"grandparent_integrity_level\": \"Medium\", \"log_type\": \"process\", \"pe_imphash\": \"19BBD9C4E73C288A3645E163F4B82682\", \"create_time\": \"2022-03-15T07:24:54.260Z\", \"status\": 0, \"parent_image\": \"C:\\\\Windows\\\\SysWOW64\\\\cmd.exe\", \"integrity_level\": \"Medium\", \"usersid\": \"S-1-5-21-299502267-725345543-82448378-2366\", \"pe_info\": {\"product_version\": \"10.0.19041.1\", \"legal_copyright\": \"\\u00a9 Microsoft Corporation. All rights reserved.\", \"original_filename\": \"tasklist.exe\", \"company_name\": \"Microsoft Corporation\", \"file_description\": \"Lists the current running tasks\", \"file_version\": \"10.0.19041.1 (WinBuild.160101.0800)\", \"internal_name\": \"tasklist.exe\", \"product_name\": \"Microsoft\\u00ae Windows\\u00ae Operating System\"}, \"session\": 3, \"pe_timestamp\": \"1994-09-11T16:43:21.000Z\", \"parent_unique_id\": \"2332edf8-70c0-43c2-4590-00f912ab3d18\", \"process_name\": \"tasklist.exe\", \"grandparent_commandline\": \"C:\\\\Program Files (x86)\\\\EPOS\\\\EPOS Connect\\\\EPOSConnect.exe 1\", \"pe_timestamp_int\": 779301801, \"grandparent_image\": \"C:\\\\Program Files (x86)\\\\EPOS\\\\EPOS Connect\\\\EPOSConnect.exe\", \"parent_commandline\": \"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /d /s /c tasklist\", \"fake_parent_unique_id\": null, \"size\": 79360, \"fake_ppid\": null, \"hashes\": {\"sha1\": \"7f50d8c3cf3ec79122a876e969bdb65d939becd0\", \"sha256\": \"76eac7b5f53e0d58a98d5a6ddf9c97e19d1462ef65c0035d7798f89988b15ab4\", \"md5\": \"0a4448b31ce7f83cb7691a2657f330f1\"}}, \"execution\": 0, \"rule_name\": \"Discovery: Process list\", \"maturity\": \"stable\", \"msg\": \"Detects the execution of tasklist.exe, a tool used to gather detailed information about a computer's active processes.\"}",
    "sekoiaio": {
      "intake": {
        "dialect": "harfanglab",
        "dialect_uuid": "3c7057d3-4689-4fae-8033-6f1f887a70f2"
      }
    }
  },
  "expected": {
    "message": "{\"@version\": \"1\", \"agent\": {\"agentid\": \"00000000-0000-0000-0000-000000000000\", \"distroid\": null, \"domainname\": \"domain123\", \"ostype\": \"windows\", \"hostname\": \"pc123\", \"osversion\": \"10.0.19041\", \"osproducttype\": \"Windows 10 Pro\", \"domain\": null, \"version\": \"2.12.6\"}, \"type\": \"rtlogs\", \"alert_subtype\": \"process\", \"log_type\": \"alert\", \"detection_origin\": \"agent\", \"tenant\": \"\", \"alert_time\": \"2022-03-15T07:26:01.276+00:00\", \"alert_type\": \"sigma\", \"status\": \"false_positive\", \"rule_id\": \"00000000-0000-0000-0000-000000000000\", \"@event_create_date\": \"2022-03-15T07:26:01.276Z\", \"alert_unique_id\": \"00000000-0000-0000-0000-000000000000\", \"level\": \"low\", \"aggregation_key\": \"123456\", \"@timestamp\": \"2022-03-15T07:26:01.311Z\", \"tags\": [\"attack.discovery\", \"attack.t1057\", \"attack.s0057\"], \"process\": {\"detection_timestamp\": \"2022/03/15 07:24:54.438105\", \"process_unique_id\": \"00000000-0000-0000-0000-000000000000\", \"parent_integrity_level\": \"Medium\", \"log_platform_flag\": 0, \"fake_parent_image\": null, \"pid\": 11320, \"image_name\": \"C:\\\\Windows\\\\SysWOW64\\\\tasklist.exe\", \"username\": \"XXX\\\\XXX\", \"logonid\": 151210562, \"signature_info\": {\"signed_authenticode\": false, \"signed_catalog\": true, \"root_info\": {\"thumbprint\": \"3b1efd3a66ea28b16697394703a72ca340a05bd5\", \"display_name\": \"Microsoft Root Certificate Authority 2010\", \"serial_number\": \"28cc3a25bfba44ac449a9b586b4339aa\", \"issuer_name\": \"Microsoft Root Certificate Authority 2010\"}, \"signer_info\": {\"thumbprint\": \"f7c2f2c96a328c13cda8cdb57b715bdea2cbd1d9\", \"display_name\": \"Microsoft Windows\", \"serial_number\": \"33000002ec6579ad1e670890130000000002ec\", \"issuer_name\": \"Microsoft Windows Production PCA 2011\"}}, \"current_directory\": \"C:\\\\Program Files (x86)\\\\EPOS\\\\EPOS Connect\", \"error_msg\": \"\", \"status_msg\": \"sigma match detected this process but not configured to block it\", \"ppid\": 17808, \"fake_parent_commandline\": null, \"commandline\": \"tasklist\", \"signed\": true, \"grandparent_integrity_level\": \"Medium\", \"log_type\": \"process\", \"pe_imphash\": \"19BBD9C4E73C288A3645E163F4B82682\", \"create_time\": \"2022-03-15T07:24:54.260Z\", \"status\": 0, \"parent_image\": \"C:\\\\Windows\\\\SysWOW64\\\\cmd.exe\", \"integrity_level\": \"Medium\", \"usersid\": \"S-1-5-21-299502267-725345543-82448378-2366\", \"pe_info\": {\"product_version\": \"10.0.19041.1\", \"legal_copyright\": \"\\u00a9 Microsoft Corporation. All rights reserved.\", \"original_filename\": \"tasklist.exe\", \"company_name\": \"Microsoft Corporation\", \"file_description\": \"Lists the current running tasks\", \"file_version\": \"10.0.19041.1 (WinBuild.160101.0800)\", \"internal_name\": \"tasklist.exe\", \"product_name\": \"Microsoft\\u00ae Windows\\u00ae Operating System\"}, \"session\": 3, \"pe_timestamp\": \"1994-09-11T16:43:21.000Z\", \"parent_unique_id\": \"2332edf8-70c0-43c2-4590-00f912ab3d18\", \"process_name\": \"tasklist.exe\", \"grandparent_commandline\": \"C:\\\\Program Files (x86)\\\\EPOS\\\\EPOS Connect\\\\EPOSConnect.exe 1\", \"pe_timestamp_int\": 779301801, \"grandparent_image\": \"C:\\\\Program Files (x86)\\\\EPOS\\\\EPOS Connect\\\\EPOSConnect.exe\", \"parent_commandline\": \"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /d /s /c tasklist\", \"fake_parent_unique_id\": null, \"size\": 79360, \"fake_ppid\": null, \"hashes\": {\"sha1\": \"7f50d8c3cf3ec79122a876e969bdb65d939becd0\", \"sha256\": \"76eac7b5f53e0d58a98d5a6ddf9c97e19d1462ef65c0035d7798f89988b15ab4\", \"md5\": \"0a4448b31ce7f83cb7691a2657f330f1\"}}, \"execution\": 0, \"rule_name\": \"Discovery: Process list\", \"maturity\": \"stable\", \"msg\": \"Detects the execution of tasklist.exe, a tool used to gather detailed information about a computer's active processes.\"}",
    "event": {
      "category": [
        "process"
      ],
      "dataset": "alert",
      "kind": "alert",
      "type": [
        "start"
      ]
    },
    "@timestamp": "2022-03-15T07:26:01.276000Z",
    "agent": {
      "id": "00000000-0000-0000-0000-000000000000",
      "name": "harfanglab"
    },
    "file": {
      "hash": {
        "md5": "0a4448b31ce7f83cb7691a2657f330f1",
        "sha1": "7f50d8c3cf3ec79122a876e969bdb65d939becd0",
        "sha256": "76eac7b5f53e0d58a98d5a6ddf9c97e19d1462ef65c0035d7798f89988b15ab4"
      }
    },
    "harfanglab": {
      "aggregation_key": "123456",
      "alert_subtype": "process",
      "alert_time": "2022-03-15T07:26:01.276+00:00",
      "alert_unique_id": "00000000-0000-0000-0000-000000000000",
      "execution": 0,
      "level": "low",
      "status": "false_positive"
    },
    "host": {
      "domain": "domain123",
      "hostname": "pc123",
      "name": "pc123",
      "os": {
        "full": "Windows 10 Pro",
        "version": "10.0.19041"
      }
    },
    "log": {
      "hostname": "pc123"
    },
    "process": {
      "command_line": "tasklist",
      "executable": "C:\\Windows\\SysWOW64\\tasklist.exe",
      "name": "tasklist.exe",
      "parent": {
        "command_line": "C:\\WINDOWS\\system32\\cmd.exe /d /s /c tasklist",
        "executable": "C:\\Windows\\SysWOW64\\cmd.exe"
      },
      "pe": {
        "company": "Microsoft Corporation",
        "description": "Lists the current running tasks",
        "file_version": "10.0.19041.1 (WinBuild.160101.0800)",
        "imphash": "19BBD9C4E73C288A3645E163F4B82682",
        "original_file_name": "tasklist.exe",
        "product": "Microsoft\u00ae Windows\u00ae Operating System"
      },
      "pid": 11320,
      "working_directory": "C:\\Program Files (x86)\\EPOS\\EPOS Connect"
    },
    "related": {
      "hash": [
        "0a4448b31ce7f83cb7691a2657f330f1",
        "76eac7b5f53e0d58a98d5a6ddf9c97e19d1462ef65c0035d7798f89988b15ab4",
        "7f50d8c3cf3ec79122a876e969bdb65d939becd0"
      ],
      "hosts": [
        "pc123"
      ],
      "user": [
        "XXX\\XXX"
      ]
    },
    "rule": {
      "category": "sigma",
      "description": "Detects the execution of tasklist.exe, a tool used to gather detailed information about a computer's active processes.",
      "id": "00000000-0000-0000-0000-000000000000",
      "name": "Discovery: Process list"
    },
    "user": {
      "name": "XXX\\XXX"
    }
  }
}